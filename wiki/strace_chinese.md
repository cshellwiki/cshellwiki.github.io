# [Linux] Bash strace 用法: 追踪系统调用和信号

## 概述
`strace` 是一个强大的调试工具，用于跟踪进程执行时的系统调用和信号。它可以帮助开发者和系统管理员了解程序的行为，诊断问题，或者进行性能分析。

## 用法
基本语法如下：
```bash
strace [options] [arguments]
```

## 常用选项
- `-c`：统计每个系统调用的时间和次数。
- `-e trace=<set>`：指定要追踪的系统调用类型。
- `-p <pid>`：附加到一个正在运行的进程。
- `-o <file>`：将输出写入指定文件，而不是标准输出。

## 常见示例
1. **追踪一个新进程的系统调用**
   ```bash
   strace ls
   ```
   这将追踪 `ls` 命令的所有系统调用。

2. **统计系统调用的时间和次数**
   ```bash
   strace -c ls
   ```
   这将输出 `ls` 命令执行过程中每个系统调用的统计信息。

3. **追踪特定类型的系统调用**
   ```bash
   strace -e trace=open,close ls
   ```
   这将只追踪 `open` 和 `close` 系统调用。

4. **附加到一个正在运行的进程**
   ```bash
   strace -p 1234
   ```
   这将附加到进程 ID 为 1234 的进程，并开始追踪其系统调用。

5. **将输出写入文件**
   ```bash
   strace -o output.txt ls
   ```
   这将把 `ls` 命令的系统调用输出写入 `output.txt` 文件。

## 提示
- 使用 `-c` 选项可以快速了解程序的性能瓶颈。
- 在生产环境中使用 `strace` 时要小心，因为它可能会影响程序的性能。
- 结合 `grep` 使用 `strace` 输出，可以快速找到感兴趣的系统调用。
- 确保有足够的权限来追踪某些进程，特别是系统进程。